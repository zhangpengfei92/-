<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
	
	
	<c:if test="${status gt 0 }">
		<c:if test="${status eq 3 }">
			<h1>查询用户信息条件中必须有交易用户</h1>
		</c:if>
	
	</c:if>		
	<c:if test="${status eq 0 }">
			<div class="mtable">
                <table width="100%;" id="currhodertable">
                          <tr class="tit">
						<td >序号</td>
						<td >用户账户</td>
						<td >所属渠道</td>
						<td >所属代理商</td>
						<td >所属经纪人</td>
						<td >合约代码</td>
						<td >合约名称</td>
						<td >方向</td>
						<td >总持仓</td>
						<c:if test="${empty lsflag or lsflag eq 1}">
							<td >昨仓</td>
							<td >今仓</td>
							<td >可平量</td>
						</c:if>
						<td >持仓均价</td>
						<td >持仓盈亏</td>
					</tr>
                     	<c:forEach items="${page.list}" var="holder" varStatus="st">
						<tr>
							<td>${(page.pagenum-1)*page.pagesize + st.count}</td>
							<td>${holder.sub_zh}</td>
							<td>${holder.channel}</td>
							<td>${holder.agentzh}</td>
							<td>${holder.broker}</td>
							<td>${holder.code}</td>
							<td>${holder.name}</td>
							<td>${holder.agent}</td>
							<td>${holder.position_vol}</td>
							<c:if test="${empty lsflag or lsflag eq 1}">
								<td>${holder.history_vol}</td>
								<td>${holder.today_vol}</td>
								<td>${holder.sell_vol}</td>
							</c:if>
							<td> <fmt:formatNumber type="number" value="${holder.price}" maxFractionDigits="2"/></td>
							<td>${holder.profit}</td>
						</tr>
					</c:forEach>
				</table>
 				</div>
 				<div class="page">
					<c:choose>
							<c:when test="${empty page.pagecount || page.pagecount==0}">0/0</c:when>
							<c:otherwise>${page.pagenum}/${page.pagecount}</c:otherwise>
						</c:choose> 共<i>${empty page.pagecount ? 0 : page.pagecount}</i>页
					<a class="bs" href="javascript:;" onclick="serach('1')">首页</a>
					<input type="hidden" value="${page.pagecount}" id="pages" />
					<c:if test="${page.pagenum!=1}">
						<a class="bs" href="javascript:;" onclick="serach('${page.pagenum-1}')">上一页</a>
					</c:if>
					<c:if test="${page.pagenum!=page.pagecount}">
						<a class="bs" href="javascript:;" onclick="serach('${page.pagenum+1}')">下一页</a>
					</c:if>
					<a class="bs" href="javascript:;" onclick="serach('${page.pagecount}')">尾页</a>
					<a ><input type="text" id="pageNum" value="${page.pagenum}" style="height: 30px;line-height: 30px;padding: 0 5px;"/></a>
					<a style="cursor: pointer;" type="button" onclick="tzfy()">跳转</a>
				</div>
				
		</c:if>
		
		<script type="text/javascript" >
		$(function(){
			var array = new Array();  //定义数组 
		     $("#subzh option").each(function(){  //遍历所有option
		          var txt = $(this).val();   //获取option值 
		          if(txt!=''){
		               array.push(txt);  //添加到数组中
		          }
		     })
		     $("#subzhs").val(array);
		     var formdate=$("#frm").serializeArray();
		     var html='';
			$.post("${path}/trade/getTotalHoder",formdate,function(data){
				if(data !=null ){
					html=html+"<tr><td>合计:</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>"+data.position_vol.toFixed(2)+"</td><td>"+data.history_vol.toFixed(2)+"</td><td>"+data.today_vol.toFixed(2)+"</td><td>"+data.sell_vol.toFixed(2)+"</td><td></td><td>"+data.profit.toFixed(2)+"</td></tr>";
				}else{
					html=html+"<tr><td>合计:</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";	
				}
			$("#currhodertable").append(html);
			})
		});
		</script>
